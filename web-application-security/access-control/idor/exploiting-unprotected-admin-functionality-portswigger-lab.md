# Exploiting Unprotected Admin Functionality (PortSwigger Lab)

## **Exploiting Unprotected Admin Functionality – PortSwigger Lab Analysis**

**Lab Description**

This lab demonstrates an **Insecure Direct Object Reference (IDOR)** vulnerability in an **unprotected admin functionality endpoint**. The goal is to locate and access the hidden **admin panel** using information from the `robots.txt` file and exploit the lack of authentication to perform **unauthorized actions**, such as deleting a user account.

* **Lab URL**: [PortSwigger Unprotected Admin Functionality Lab](https://portswigger.net/web-security/access-control/lab-unprotected-admin-functionality)
* **Target:** Delete the victim user **Carlos** by accessing an unprotected admin panel.

***

### **Analysis and Exploitation**

#### **1. Understanding the IDOR Vulnerability**

* **Why is this an IDOR?**
  * The admin panel is **exposed but not authenticated**, allowing any user to access it.
  * The application fails to **validate user permissions**, allowing non-admin users to perform administrative actions.
  * Sensitive functionality is **discoverable in `robots.txt`**, which should never be relied on as a security measure.
* **Why `robots.txt` is not a security control:**
  * It **only advises search engines** on what not to index.
  * Attackers can still **manually access** the restricted endpoints.

***

#### **2. Exploiting the Vulnerability**

**Step 1: Locate the Admin Panel in `robots.txt`**

1. Append `/robots.txt` to the lab URL and open it in the browser:
   * **Example:** `https://<lab-url>/robots.txt`.
2. Review the contents for **Disallowed paths**:
   * **Example:** `Disallow: /administrator-panel`.

**Step 2: Access the Unprotected Admin Panel**

1. Replace `/robots.txt` in the URL with the discovered path:
   * **Example:** `https://<lab-url>/administrator-panel`.
2. Navigate to the page and confirm that the **admin panel loads without authentication**.

**Step 3: Delete Carlos’s Account**

1. In the admin panel, locate the **user management or delete function**.
2. Select **Carlos** from the user list and trigger the **delete action**.
3. Confirm that Carlos’s account is deleted and the lab is completed.

***

#### **3. Why This Works (Security Breakdown)**

* **No authentication or authorization checks** protect the admin panel.
* **Relying on obscurity (`robots.txt`)** is ineffective because it does not enforce security, only hides information from search engines.
* **Broken Access Control** allows **unauthorized execution of administrative actions** (deleting a user).

***

### **Key Takeaways**

#### **1. Security Misconfigurations Lead to IDOR**

* **Hidden endpoints should always require authentication.**
* **Access control must be enforced at the server level**, not just through UI elements or obscurity.

#### **2. Why Obscurity is Not Security**

* Sensitive functionality **must be protected with proper authentication and role-based access controls (RBAC)**.
* **Attackers will manually inspect `robots.txt`**, directory listings, or other exposed endpoints to find hidden resources.

#### **3. Proper Access Control Implementation**

* **Use authentication mechanisms** for all privileged areas.
* **Restrict admin functionality** to authorized users using **role-based access control (RBAC)**.
* **Monitor and log unauthorized access attempts** to detect potential exploits.

***

### **Security Best Practices to Prevent This Vulnerability**

#### **1. Implement Proper Authentication and Authorization**

* Ensure **all admin functionality requires login and proper privileges**.
* Enforce **role-based access control (RBAC)** so only authorized users can access sensitive actions.

#### **2. Remove Sensitive Endpoints from Publicly Accessible Files**

* **Do not disclose admin paths** in `robots.txt` or client-side code.
* Use **server-side access control** to protect sensitive endpoints instead of hiding them.

#### **3. Implement Logging and Monitoring**

* Track **unauthorized access attempts** to sensitive endpoints.
* Detect repeated access attempts to **`robots.txt` or unprotected admin URLs**.

***

### **Final Thoughts**

This lab highlights **how poor access control implementations** can expose critical functionality to unauthorized users. **Access control should never rely on obscurity**—instead, **authentication and proper role-based restrictions** must be in place to prevent unauthorized actions.

By enforcing **server-side access control and restricting admin functionality**, organizations can effectively mitigate **IDOR and access control vulnerabilities** that could lead to unauthorized account modifications or deletions.
